<header class="modern-header">
    <nav class="container navbar-modern">
        <div class="header-logo">
            <a href="/">
                <img src="/image/logo-ppi.png" alt="PPI AIU Logo">
            </a>
            <span class="header-logo-name">PPI AIU</span>
        </div>
        <ul class="nav-menu">
            <li class="nav-item"><a href="/" class="nav-link"><%= t('navigation.home') %></a></li>
            <li class="nav-item"><a href="/periode" class="nav-link"><%= t('navigation.members') %></a></li>
            <li class="nav-item"><a href="/blog" class="nav-link"><%= t('navigation.blog') %></a></li>
            <li class="nav-item"><a href="/fondasi" class="nav-link"><%= t('navigation.foundation') %></a></li>
            
            <!-- Language Switcher -->
            <li class="nav-item language-switcher">
                <div class="language-dropdown">
                    <button class="language-btn" type="button">
                        <% 
                        const currentFlag = availableLocales.find(l => l.code === locale)?.flag || 'ðŸŒ';
                        const currentName = availableLocales.find(l => l.code === locale)?.name || locale.toUpperCase();
                        %>
                        <span class="current-lang">
                            <%= currentFlag %> <%= currentName %>
                        </span>
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="language-menu">
                        <% availableLocales.forEach(function(lang) { %>
                            <button class="language-option <%= locale === lang.code ? 'active' : '' %>" 
                                    data-lang="<%= lang.code %>">
                                <span class="lang-flag"><%= lang.flag %></span>
                                <span class="lang-name"><%= lang.name %></span>
                                <% if (locale === lang.code) { %>
                                    <i class="fas fa-check lang-check"></i>
                                <% } %>
                            </button>
                        <% }); %>
                    </div>
                </div>
            </li>
            
            <% if(currentUser) { %>
            <li class="nav-item"><a href="/logout" class="nav-link" onclick="
            event.preventDefault();
            document.getElementById('logout-form').submit();"
                >Logout</a>
            <form id="logout-form" action="/logout" method="post" style="display: none;" >
            </form>
            </li>
            <% } else { %>
            <li class="nav-item"><a href="/login" class="nav-link">Login</a></li>
                <% } %>

        </ul>
        <div class="hamburger">
            <span class="bar"></span>
            <span class="bar"></span>
            <span class="bar"></span>
        </div>
    </nav>

<script>
    const hamburger = document.querySelector('.hamburger');
    const navMenu = document.querySelector('.nav-menu');

    hamburger.addEventListener('click', mobileMenu);
    function mobileMenu() {
        hamburger.classList.toggle('active');
        navMenu.classList.toggle('active');
    }

// when we click on hamburger icon its close 
    const headerLink = document.querySelectorAll('.nav-link');
    headerLink.forEach(n => n.addEventListener('click', closeMenu)) 

    function closeMenu() {
        hamburger.classList.remove('active');
        navMenu.classList.remove('active');
    }

    // Language Switcher functionality
    const languageBtn = document.querySelector('.language-btn');
    const languageMenu = document.querySelector('.language-menu');
    const languageOptions = document.querySelectorAll('.language-option');

    if (languageBtn && languageMenu) {
        languageBtn.addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();
            languageMenu.classList.toggle('active');
        });

        // Close language menu when clicking outside
        document.addEventListener('click', function(e) {
            if (!languageBtn.contains(e.target) && !languageMenu.contains(e.target)) {
                languageMenu.classList.remove('active');
            }
        });

        // Handle language selection
        languageOptions.forEach(option => {
            option.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                
                const selectedLang = this.dataset.lang;
                const currentUrl = window.location.pathname + window.location.search;
                
                // Create form data
                const formData = new FormData();
                formData.append('language', selectedLang);
                formData.append('returnUrl', currentUrl);
                
                // Send AJAX request
                fetch('/switch-language', {
                    method: 'POST',
                    body: formData,
                    headers: {
                        'X-Requested-With': 'XMLHttpRequest'
                    }
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        // Reload the page to apply new language
                        window.location.reload();
                    }
                })
                .catch(error => {
                    console.error('Language switch error:', error);
                    // Fallback: submit form normally
                    const form = document.createElement('form');
                    form.method = 'POST';
                    form.action = '/switch-language';
                    form.style.display = 'none';
                    
                    const langInput = document.createElement('input');
                    langInput.type = 'hidden';
                    langInput.name = 'language';
                    langInput.value = selectedLang;
                    
                    const urlInput = document.createElement('input');
                    urlInput.type = 'hidden';
                    urlInput.name = 'returnUrl';
                    urlInput.value = currentUrl;
                    
                    form.appendChild(langInput);
                    form.appendChild(urlInput);
                    document.body.appendChild(form);
                    form.submit();
                });
                
                languageMenu.classList.remove('active');
            });
        });
    }

</script>
</header>

