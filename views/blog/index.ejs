
<% layout('layouts/app') %>

<!-- Modern Page Header -->
<section class="page-header">
    <div class="container">
        <h1 class="page-title">Activities & Events</h1>
        <p class="page-subtitle">Discover the latest news, events, and achievements from PPI AIU</p>
    </div>
</section>

<!-- Modern Toolbar & Filter -->
<section class="toolbar-modern">
    <div class="container-modern toolbar-flex">
        <% if (currentUser) { %>
            <div class="admin-controls-modern">
                <a href="/activity/new" class="btn-modern primary"><i class="fas fa-plus"></i> Add Activity</a>
                <a href="/activity" class="btn-modern"><i class="fas fa-list"></i> Manage</a>
            </div>
        <% } %>
        <div class="search-filter-modern">
            <input type="text" class="search-modern" placeholder="Search activities..." onkeyup="filterActivities(this.value)">
            <div class="filter-group-modern">
                <button onclick="filterByCategory('all')" class="filter-btn-modern active" data-category="all"><i class="fas fa-th"></i> All</button>
                <button onclick="filterByCategory('academic')" class="filter-btn-modern" data-category="academic"><i class="fas fa-graduation-cap"></i> Academic</button>
                <button onclick="filterByCategory('social')" class="filter-btn-modern" data-category="social"><i class="fas fa-users"></i> Social</button>
                <button onclick="filterByCategory('sports')" class="filter-btn-modern" data-category="sports"><i class="fas fa-futbol"></i> Sports</button>
                <button onclick="filterByCategory('culture')" class="filter-btn-modern" data-category="culture"><i class="fas fa-palette"></i> Culture</button>
            </div>
        </div>
    </div>
</section>

<!-- Modern Activities Grid -->
<section class="activities-modern">
    <div class="container-modern">
        <% if (activities && activities.length > 0) { %>
            <div class="activities-grid-modern">
                <% activities.forEach((activity, index) => { %>
                    <div class="activity-card-modern" data-category="<%= activity.category %>" data-title="<%= activity.title.toLowerCase() %>" data-department="<%= activity.department.toLowerCase() %>">
                        <div class="activity-image-modern">
                            <% if (activity.hasImage) { %>
                                <img src="<%= activity.image.path %>" alt="<%= activity.title %>">
                            <% } else { %>
                                <div class="activity-placeholder-modern"><i class="<%= activity.placeholderIcon || 'fas fa-calendar' %>"></i></div>
                            <% } %>
                            <span class="activity-category-modern"><%= activity.category === 'academic' ? (activity.subCategory || 'academic') : activity.category %></span>
                        </div>
                        <div class="activity-content-modern">
                            <h2 class="activity-title-modern"><%= activity.title %></h2>
                            <% if (activity.subCategory === 'article' || activity.subCategory === 'journal') { %>
                                <div class="activity-article-info-modern">
                                    <% if (activity.author) { %>
                                        <p><i class="fas fa-user-edit"></i> <strong>Author(s):</strong> <%= activity.author %></p>
                                    <% } %>
                                    <% if (activity.publishDate) { %>
                                        <p><i class="fas fa-calendar-alt"></i> <strong>Published:</strong> <%= new Date(activity.publishDate).toLocaleDateString() %></p>
                                    <% } %>
                                    <% if (activity.pdfFile && activity.pdfFile.path) { %>
                                        <p><a href="/activity/<%= activity._id %>/pdf" target="_blank" class="pdf-link-modern"><i class="fas fa-file-pdf"></i> Download PDF</a></p>
                                    <% } else if (activity.subCategory === 'article' || activity.subCategory === 'journal') { %>
                                        <p class="pdf-not-available-modern"><i class="fas fa-info-circle"></i> PDF file not available</p>
                                    <% } %>
                                </div>
                            <% } %>
                            <% if (activity.subCategory !== 'article' && activity.subCategory !== 'journal') { %>
                                <p class="activity-tagline-modern">"<%= activity.tagline %>"</p>
                            <% } %>
                            <p class="activity-excerpt-modern"><%= (activity.subCategory === 'article' || activity.subCategory === 'journal') && activity.abstract ? activity.abstract : activity.description %></p>
                            <% if ((activity.subCategory === 'article' || activity.subCategory === 'journal') && activity.keywords && activity.keywords.length > 0) { %>
                                <div class="activity-keywords-modern">
                                    <span><i class="fas fa-tags"></i> Keywords:</span>
                                    <% activity.keywords.forEach((keyword, i) => { %>
                                        <span class="keyword-modern"><%= keyword %></span>
                                    <% }) %>
                                </div>
                            <% } %>
                            <div class="activity-meta-modern">
                                <span class="activity-department-modern"><i class="<%= activity.departmentIcon || 'fas fa-users' %>"></i> <%= activity.department %></span>
                            </div>
                            <% if (currentUser) { %>
                                <div class="activity-controls-modern">
                                    <a href="/activity/<%= activity._id %>/edit" class="btn-modern edit"><i class="fas fa-edit"></i> Edit</a>
                                    <form method="POST" action="/activity/<%= activity._id %>?_method=DELETE" style="display: inline;" onsubmit="return confirm('Are you sure you want to delete this activity?')">
                                        <button type="submit" class="btn-modern delete"><i class="fas fa-trash-alt"></i> Delete</button>
                                    </form>
                                </div>
                            <% } %>
                        </div>
                    </div>
                <% }) %>
            </div>
        <% } else { %>
            <div class="empty-modern">
                <i class="fas fa-calendar-times"></i>
                <h2>No Activities Yet</h2>
                <p>Check back soon for upcoming events and activities!</p>
                <% if (currentUser) { %>
                    <a href="/activity/new" class="btn-modern primary">Add First Activity</a>
                <% } %>
            </div>
        <% } %>
    </div>
</section>

<!-- Modern CTA -->
<section class="cta-modern">
    <div class="container-modern">
        <h2 class="cta-heading-modern">Want to Join Our Activities?</h2>
        <p class="cta-text-modern">Stay updated with our latest events and programs</p>
        <div class="cta-buttons-modern">
            <a href="#contact" class="btn-modern primary">Contact Us</a>
            <a href="/periode" class="btn-modern secondary">Meet The Team</a>
        </div>
    </div>
</section>

<script>
    // Filter Activities by Category
    function filterByCategory(category) {
        const articles = document.querySelectorAll('.activity-card-modern');
        const filterButtons = document.querySelectorAll('.filter-btn-modern');
        filterButtons.forEach(btn => btn.classList.remove('active'));
        document.querySelector(`[data-category="${category}"]`).classList.add('active');
        articles.forEach(article => {
            if (category === 'all' || article.dataset.category === category) {
                article.classList.remove('activity-hidden');
            } else {
                article.classList.add('activity-hidden');
            }
        });
    }
    // Search Activities
    function filterActivities(searchTerm) {
        const articles = document.querySelectorAll('.activity-card-modern');
        const term = searchTerm.toLowerCase();
        articles.forEach(article => {
            const title = article.dataset.title;
            const department = article.dataset.department;
            if (title.includes(term) || department.includes(term)) {
                article.classList.remove('activity-hidden');
            } else {
                article.classList.add('activity-hidden');
            }
        });
    }
</script>
